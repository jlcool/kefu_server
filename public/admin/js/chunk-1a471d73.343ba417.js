(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1a471d73"],{"0344":function(e,t,i){},"0b10":function(e,t,i){},"11e9":function(e,t,i){var s=i("52a7"),n=i("4630"),o=i("6821"),a=i("6a99"),r=i("69a8"),c=i("c69a"),l=Object.getOwnPropertyDescriptor;t.f=i("9e1e")?l:function(e,t){if(e=o(e),t=a(t,!0),c)try{return l(e,t)}catch(i){}if(r(e,t))return n(!s.f.call(e,t),e[t])}},1826:function(e,t,i){"use strict";var s=i("fa4e"),n=i.n(s);n.a},"1c01":function(e,t,i){var s=i("5ca1");s(s.S+s.F*!i("9e1e"),"Object",{defineProperty:i("86cc").f})},"24fd":function(e,t,i){"use strict";var s=i("4e10"),n=i.n(s);n.a},"297c":function(e,t,i){"use strict";var s=i("0b10"),n=i.n(s);n.a},"29e5":function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"mini-im-workbench"},[i("div",{staticClass:"mini-im-session-list"},[i("div",{staticClass:"title"},[i("el-row",{attrs:{type:"flex",justify:"space-between",gutter:20}},[i("el-col",{attrs:{span:16}},[i("span",[i("i",{staticClass:"el-icon-s-custom"}),e._v("\n                 ‰ºöËØùÂàóË°® ( "+e._s(e.contacts.length)+"‰∫∫ )\n               ")]),i("i",{staticClass:"el-icon-delete",staticStyle:{cursor:"pointer"},attrs:{title:"Ê∏ÖÁ©∫ÂàóË°®"},on:{click:e.clearContact}})]),i("el-col",{attrs:{span:9}},[i("el-popover",{attrs:{placement:"bottom",width:"100"}},[i("div",{staticClass:"mini-im-online-setting"},[1!=e.adminInfo.online?i("div",{staticClass:"item",on:{click:function(){return e.online(1)}}},[i("i",{staticClass:"el-icon-circle-check",staticStyle:{color:"rgb(135, 208, 104)"}}),e._v("\n                       ÊàëË¶Å‰∏äÁ∫ø\n                     ")]):e._e(),0!=e.adminInfo.online?i("div",{staticClass:"item",on:{click:function(){return e.online(0)}}},[i("i",{staticClass:"el-icon-switch-button",staticStyle:{color:"#ccc"}}),e._v("\n                       ÊàëË¶Å‰∏ãÁ∫ø\n                     ")]):e._e(),2!=e.adminInfo.online?i("div",{staticClass:"item",on:{click:function(){return e.online(2)}}},[i("i",{staticClass:"el-icon-remove-outline",staticStyle:{color:"#e6a23c"}}),e._v("\n                       ÁπÅÂøôÁä∂ÊÄÅ\n                     ")]):e._e()]),0==e.adminInfo.online?i("el-button",{attrs:{slot:"reference",size:"mini"},slot:"reference"},[i("i",{staticClass:"el-icon-switch-button"}),i("em",[e._v("Á¶ª Á∫ø ")]),i("i",{staticClass:"el-icon-arrow-right el-icon--right"})]):1==e.adminInfo.online?i("el-button",{attrs:{slot:"reference",size:"mini"},slot:"reference"},[i("span",{staticStyle:{color:"rgb(135, 208, 104)"}},[i("i",{staticClass:"el-icon-circle-check"}),i("em",[e._v("Âú® Á∫ø")]),i("i",{staticClass:"el-icon-arrow-right el-icon--right"})])]):i("el-button",{attrs:{slot:"reference",size:"mini"},slot:"reference"},[i("span",{staticStyle:{color:"#e6a23c"}},[i("i",{staticClass:"el-icon-circle-check"}),i("em",[e._v("ÁπÅ Âøô")]),i("i",{staticClass:"el-icon-arrow-right el-icon--right"})])])],1)],1)],1)],1),i("div",{staticClass:"mini-im-session-content"},[i("div",{staticClass:"mini-im-flex"},[e.contacts.length<=0?i("div",{staticClass:"mini-im-no-data"},[e._v("ÊöÇÊó†‰ºöËØùÊï∞ÊçÆ")]):e._e(),e._l(e.contacts,(function(t,s){return i("ContactComponent",{key:s,class:{"mini-im-chat-item-active":e.seviceCurrentUser.from_account==t.from_account},attrs:{deleteContact:e.deleteContact,clickItem:e.selectUser,item:t}})}))],2)])]),e.$store.getters.seviceCurrentUser.id?i("div",{staticClass:"mini-im-chat-view"},[i("div",{staticClass:"mini-im-chat-view-content-header"},[i("div",{staticClass:"mini-im-header-user-box"},[i("el-avatar",{staticClass:"mini-im-avatar",attrs:{size:35}},[""!=e.seviceCurrentUser.avatar?i("img",{attrs:{src:e.seviceCurrentUser.avatar}}):[e._v("ËÆø")]],2),i("div",{staticClass:"mini-im-header-user-info"},[i("div",[e._v("\n                 "+e._s(e.seviceCurrentUser.nickname)+"\n                 "),1==e.seviceCurrentUser.online?i("span",{staticStyle:{color:"rgb(135, 208, 104)"}},[e._v("‚óè Âú®Á∫ø")]):i("span",[e._v("‚óè Á¶ªÁ∫ø")]),e.isInputPongIng?[i("span",{staticClass:"input-pong"},[e._v(e._s(e.inputPongIngString)+" "),i("i",{staticClass:"el-icon-edit"})])]:e._e()],2),i("span",[e._v("Áî®Êà∑Êù•Ëá≥Ôºö"+e._s(e.$getPlatformItem(e.seviceCurrentUser.platform).title)+"ÂÆ¢Êà∑Á´ØÔºåÊâÄÂú®Âú∞Ôºö"+e._s(e.seviceCurrentUser.address||"Êú™Áü•"))])])],1),i("el-row",{staticClass:"mini-im-buttons"},[i("el-popover",{attrs:{placement:"bottom",width:"200",trigger:"click"}},[i("div",{staticClass:"mini-im-customer-list"},[i("div",{staticClass:"mini-im-customer-title"},[e._v("ËØ∑ÈÄâÊã©ËΩ¨Êé•ÁöÑÂÆ¢Êúç ("+e._s(e.filterAdmins.length)+"‰∫∫Âú®Á∫ø)")]),e._l(e.filterAdmins,(function(t){return i("div",{key:t.id,staticClass:"mini-im-customer-item",on:{click:function(){return e.transferCustomer(t)}}},[i("el-avatar",{staticClass:"mini-im-avatar",attrs:{size:30}},[i("img",{attrs:{src:t.avatar}})]),i("span",[e._v(e._s(t.nickname||t.username))])],1)})),0==e.filterAdmins.length?i("div",{staticClass:"mini-im-customer-item",staticStyle:{background:"none",border:"0"}},[i("span",[e._v("ÂΩìÂâçÊ≤°ÊúâÂÖ∂‰ªñÂÆ¢ÊúçÂú®Á∫ø")])]):e._e()],2),i("el-button",{directives:[{name:"show",rawName:"v-show",value:0==e.seviceCurrentUser.is_session_end&&0!=e.adminInfo.online,expression:"seviceCurrentUser.is_session_end == 0 && adminInfo.online != 0"}],attrs:{slot:"reference",icon:"el-icon-refresh",size:"small"},on:{click:e.getAdmins},slot:"reference"},[e._v("\n               ËΩ¨Êé•ÂÆ¢Êúç\n             ")])],1),0==e.seviceCurrentUser.is_session_end&&0!=e.adminInfo.online?i("el-button",{attrs:{icon:"el-icon-close",size:"small"},on:{click:e.closeSession}},[e._v("ÁªìÊùü‰ºöËØù")]):e._e()],1)],1),i("div",{ref:"miniImChatViewBontentBody",staticClass:"mini-im-chat-view-content-body"},[i("div",{staticClass:"mini-im-chat-view-content"},[i("div",{directives:[{name:"show",rawName:"v-show",value:""!=e.advanceText.trim(),expression:"advanceText.trim() != ''"}],staticClass:"advance"},[i("div",[e._v("Ê≠£Âú®ËæìÂÖ•Ôºö")]),i("span",[e._v("\n                 "+e._s(e.advanceText)+"\n                 "),e.isInputPongIng?[i("span",{staticClass:"input-pong"},[e._v(e._s(e.inputPongIngString.replace("ÂØπÊñπÊ≠£Âú®ËæìÂÖ•",""))+" "),i("i",{staticClass:"el-icon-edit"})])]:e._e()],2)]),i("div",{ref:"chatBody",staticClass:"mini-im-chat-body",attrs:{id:"chatBody"}},[i("ChatWindowComponent",{attrs:{onLoadMor:e.onLoadMorMessage,isMessageEnd:e.isMessageEnd,onCancelMessage:e.onCancelMessage,messages:e.messageRecord.list,loading:e.getMessageRecordLoading}})],1),i("div",{staticClass:"mini-im-chat-input"},[i("div",{staticClass:"mini-im-chat-input-bar"},[i("el-row",[i("EmojiComponent",{attrs:{clickEmoji:e.clickEmoji}}),i("span",{staticClass:"mini-im-button",attrs:{title:"ÈÄâÊã©ÂõæÁâá"}},[e._v("\n                       üåÅ\n                       "),i("input",{attrs:{onClick:"this.value = null",type:"file",accept:"image/*"},on:{change:e.sendPhotoMessageEvent}})])],1),i("el-row",[i("el-popover",{attrs:{placement:"top-start",width:"350",trigger:"hover"}},[i("div",{staticClass:"mini-im-shortcut"},[i("div",{staticClass:"mini-im-shortcut-head"},[i("span",[i("i",{staticClass:"el-icon-tickets"}),e._v("Âø´Êç∑ËØ≠ÂõûÂ§çÂàóË°®")]),i("div",[i("button",{attrs:{title:"Ê∑ªÂä†"},on:{click:function(t){e.createShortcutDialogFormVisible=!0}}},[i("i",{staticClass:"el-icon-plus"})]),i("button",{attrs:{title:"ÁºñËæë"},on:{click:function(t){e.shortcutEditVisible=!e.shortcutEditVisible}}},[i("i",{staticClass:"el-icon-edit"})])])]),i("div",{staticClass:"mini-im-shortcut-body"},[i("el-input",{staticStyle:{"margin-bottom":"10px"},attrs:{clearable:"",type:"text",placeholder:"ËØ∑ËæìÂÖ•ÂÖ≥ÈîÆËØç",autocomplete:"off"},model:{value:e.shortcutKey,callback:function(t){e.shortcutKey=t},expression:"shortcutKey"}}),0==e.filterShortcuts.length?i("div",{staticClass:"mini-im-shortcut-item",staticStyle:{background:"none"}},[i("span",{staticStyle:{"text-align":"center","margin-top":"20px"}},[e._v("ÊöÇÊó†Âø´Êç∑ËØ≠")])]):e._e(),e._l(e.filterShortcuts,(function(t){return i("div",{key:t.id,staticClass:"mini-im-shortcut-item",attrs:{title:t.content}},[i("span",{domProps:{innerHTML:e._s(t.title.replace(/\n/g,"<br>"))},on:{"!click":function(i){return function(){return e.checkShortcut(t.content)}()}}}),i("button",{directives:[{name:"show",rawName:"v-show",value:e.shortcutEditVisible,expression:"shortcutEditVisible"}],attrs:{title:"‰øÆÊîπ"},on:{"!click":function(i){return function(){return e.editShortcut(t)}()}}},[i("i",{staticClass:"el-icon-edit"})]),i("button",{directives:[{name:"show",rawName:"v-show",value:e.shortcutEditVisible,expression:"shortcutEditVisible"}],attrs:{title:"Âà†Èô§"},on:{"!click":function(i){return function(){return e.deleteShortcut(t)}()}}},[i("i",{staticClass:"el-icon-delete"})])])}))],2)]),i("button",{staticClass:"mini-im-button",attrs:{slot:"reference"},slot:"reference"},[i("i",{staticClass:"el-icon-tickets",staticStyle:{"font-size":"15px"}}),i("span",{staticStyle:{"font-size":"14px"}},[e._v(" Âø´Êç∑ËØ≠")])])])],1)],1),i("div",{staticClass:"mini-im-chat-input-edit",on:{keyup:[function(t){return t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:e.keyUpEvent(t)},function(t){return!t.type.indexOf("key")&&13!==t.keyCode&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:t.shiftKey?e.enterShift(t):null},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:e.sendMessage(t)}]}},[i("el-input",{ref:"chatValueDom",staticClass:"mini-im-chat-text-input",attrs:{type:"textarea",rows:"3",resize:"none",autosize:!1,disabled:1==e.seviceCurrentUser.is_session_end||0==e.adminInfo.online,maxlength:"200","show-word-limit":"",placeholder:1==e.seviceCurrentUser.is_session_end?"ÂΩìÂâç‰ºöËØùÂ∑≤ÁªìÊùü":"ËØ∑ËæìÂÖ•ÂÜÖÂÆπ"},model:{value:e.chatValue,callback:function(t){e.chatValue=t},expression:"chatValue"}})],1)])]),i("div",{staticClass:"mini-im-chat-view-user"},[i("el-tabs",{attrs:{type:"border-card"}},[i("el-tab-pane",{attrs:{label:"Áî®Êà∑‰ø°ÊÅØ"}},[i("UserInfoComponent")],1)],1)],1)])]):i("div",{staticClass:"mini-im-chat-view no-window"},[e._m(0),i("span",[e._v("ÂΩìÂâçÊó†ÂØπËØù")]),i("div",{directives:[{name:"show",rawName:"v-show",value:e.chatWindowLoading,expression:"chatWindowLoading"}],staticClass:"mini-im-right-window-loading"},[i("i",{staticClass:"el-icon-loading"}),i("span",[e._v("Êï∞ÊçÆÂä†ËΩΩ‰∏≠...")])])]),i("CreateShortcutComponent",{attrs:{complete:e.getShortcuts,dialogFormVisible:e.createShortcutDialogFormVisible},on:{"update:dialogFormVisible":function(t){e.createShortcutDialogFormVisible=t},"update:dialog-form-visible":function(t){e.createShortcutDialogFormVisible=t}}}),i("EditShortcutComponent",{attrs:{formData:e.editShortcutItem,complete:e.getShortcuts,dialogFormVisible:e.editShortcutDialogFormVisible},on:{"update:dialogFormVisible":function(t){e.editShortcutDialogFormVisible=t},"update:dialog-form-visible":function(t){e.editShortcutDialogFormVisible=t}}})],1)},n=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("i",{staticClass:"el-icon-service"})])}],o=(i("1c01"),i("58b2"),i("8e6e"),i("f3e2"),i("ac6a"),i("456d"),i("c5f6"),i("4917"),i("a481"),i("6d67"),i("57e7"),i("d25f"),i("4f37"),i("85f2")),a=i.n(o);function r(e,t,i){return t in e?a()(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var c=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-popover",{attrs:{placement:"top-start",width:"400",trigger:"hover"}},[i("div",{staticClass:"emoji-box"},e._l(e.emojis,(function(t,s){return i("span",{key:s,on:{click:function(i){return e.clickEmoji(t)}}},[e._v(e._s(t))])})),0),i("button",{staticClass:"mini-im-button",staticStyle:{"font-size":"20px"},attrs:{slot:"reference",title:"ÈÄâÊã©Ë°®ÊÉÖ"},slot:"reference"},[e._v("üòä")])])},l=[],u=i("eef3"),m={name:"mini-im-emoji",data:function(){return{emojis:u.emojiData}},props:{clickEmoji:Function}},d=m,f=(i("1826"),i("2877")),h=Object(f["a"])(d,c,l,!1,null,"3d019866",null),v=h.exports,g=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"mini-im-chat-item"},[i("span",{staticClass:"delete_contact",attrs:{title:"Âà†Èô§ËØ•ËÆ∞ÂΩï"},on:{"!click":function(t){return e.deleteContact(e.item)}}},[i("i",{staticClass:"el-icon-close"})]),i("el-avatar",{staticClass:"mini-im-avatar",on:{click:function(t){return e.clickItem(e.item)}}},[""!=e.item.avatar?i("img",{attrs:{src:e.item.avatar}}):[e._v("ËÆø")]],2),i("div",{staticClass:"mini-im-message-box",on:{click:function(t){return e.clickItem(e.item)}}},[i("div",{staticClass:"mini-im-user-date"},[i("div",{staticClass:"mini-im-nickname"},[i("span",{staticClass:"mini-im-online-status",class:{success:1==e.item.online}},[e._v("‚óè")]),e._v(" "+e._s(e.item.nickname)+"\n          ")]),i("div",{staticClass:"mini-im-date"},[e._v("\n              "+e._s(e.$formatFromNowDate(e.item.contact_create_at))+"\n          ")])]),i("div",{staticClass:"mini-im-message-badge"},["text"==e.item.last_message_type?i("div",{staticClass:"mini-im-message"},[e._v(e._s(e.item.last_message))]):e._e(),"photo"==e.item.last_message_type?i("div",{staticClass:"mini-im-message"},[e._v("Êî∂Âà∞ÂõæÁâáÊñá‰ª∂")]):e._e(),"video"==e.item.last_message_type?i("div",{staticClass:"mini-im-message"},[e._v("Êî∂Âà∞ËßÜÈ¢ëÊñá‰ª∂")]):e._e(),"end"==e.item.last_message_type?i("div",{staticClass:"mini-im-message"},[e._v("‰ºöËØùÁªìÊùü")]):e._e(),"cancel"==e.item.last_message_type?i("div",{staticClass:"mini-im-message"},[e._v("ÂØπÊñπÊí§Âõû‰∫Ü‰∏ÄÊù°Ê∂àÊÅØ")]):e._e(),"timeout"==e.item.last_message_type?i("div",{staticClass:"mini-im-message"},[e._v("‰ºöËØùË∂ÖÊó∂ÔºåÁªìÊùüÂØπËØù")]):e._e(),"transfer"==e.item.last_message_type||"handshake"==e.item.last_message_type?i("div",{staticClass:"mini-im-message"},[e._v("ÂÆ¢ÊúçËΩ¨Êé•...")]):e._e(),e.item.read>0?i("div",{staticClass:"mini-im-badge"},[e._v(e._s(e.item.read))]):e._e()])])],1)},p=[],_={name:"mini-im-contact",data:function(){return{}},props:{item:Object,clickItem:Function,deleteContact:Function}},b=_,C=(i("297c"),Object(f["a"])(b,g,p,!1,null,"595d9a46",null)),y=C.exports,w=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"mini-im-username-component-box"},[i("div",{staticClass:"mini-im-username-component"},[i("button",{attrs:{title:"ÁºñËæëÁî®Êà∑‰ø°ÊÅØ"},on:{click:function(t){e.isUserReadonly=!e.isUserReadonly}}},[i("i",{staticClass:"el-icon-edit"})])]),i("el-form",{ref:"form",class:{"form-item-readonly":e.isUserReadonly},attrs:{"label-width":"80px"}},[i("el-form-item",{staticClass:"form-item",attrs:{label:"Áî®Êà∑ÊòµÁß∞"}},[i("el-input",{attrs:{placeholder:"Ê∏∏ÂÆ¢",readonly:e.isUserReadonly,type:"text"},model:{value:e.form.nickname,callback:function(t){e.$set(e.form,"nickname",t)},expression:"form.nickname"}})],1),i("el-form-item",{staticClass:"form-item",attrs:{label:"ÊâÄÂú®Âú∞Âå∫"}},[i("el-input",{attrs:{readonly:e.isUserReadonly,placeholder:"Êó†",type:"text"},model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1),i("el-form-item",{staticClass:"form-item",attrs:{label:"ËÅîÁ≥ªÊñπÂºè"}},[i("el-input",{attrs:{readonly:e.isUserReadonly,placeholder:"Êó†ËÅîÁ≥ªÊñπÂºè",type:"text"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),i("el-form-item",{staticClass:"form-item no-border",attrs:{label:"ÊâÄÂú®Âπ≥Âè∞"}},[i("el-input",{attrs:{readonly:"",value:e.$getPlatformItem(e.user.platform).title,resize:"none",type:"text"}})],1),i("el-form-item",{staticClass:"form-item no-border",attrs:{label:"ÂàõÂª∫Êó∂Èó¥"}},[i("el-input",{attrs:{readonly:"",value:e.$formatUnixDate(e.user.create_at,"YYYY/MM/DD"),resize:"none",type:"text"}})],1),i("el-form-item",{staticClass:"form-item",attrs:{label:"Â§áÊ≥®‰ø°ÊÅØ"}},[i("el-input",{attrs:{rows:"4",readonly:e.isUserReadonly,placeholder:"Êó†Â§áÊ≥®",resize:"none",type:"textarea"},model:{value:e.form.remarks,callback:function(t){e.$set(e.form,"remarks",t)},expression:"form.remarks"}})],1),e.isUserReadonly?e._e():i("el-row",{attrs:{type:"flex",justify:"center"}},[i("el-button",{on:{click:function(t){e.isUserReadonly=!0}}},[e._v("ÂèñÊ∂à")]),i("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("‰øùÂ≠ò")])],1),e.isUserReadonly?e._e():i("div",{staticStyle:{"text-align":"center","font-size":"12px",color:"#666","margin-top":"15px"}},[e._v("ÂΩìÂâç‰∏∫ÁºñËæëÊ®°Âºè")])],1)],1)},S=[],k=i("bc3a"),x=i.n(k),$={name:"mini-im-user-info",data:function(){return{form:{id:"",nickname:"",address:"",phone:"",remarks:""},isUserReadonly:!0}},computed:{user:function(){return this.$store.getters.seviceCurrentUser||{}}},methods:{save:function(){var e=this;x.a.put("/user",this.form).then((function(){e.isUserReadonly=!0})).catch((function(t){e.$message.error(t.response.data.message)}))}},watch:{user:function(e){e.id!=this.form.id&&(this.isUserReadonly=!0),(this.isUserReadonly||e.id!=this.form.id)&&(this.form=this.user)}}},I=$,M=(i("2b0b"),Object(f["a"])(I,w,S,!1,null,null,null)),U=M.exports,E=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{attrs:{width:"600px",title:"Ê∑ªÂä†Âø´Êç∑ËØ≠","show-close":!1,visible:e.dialogFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[i("el-form",{attrs:{model:e.form}},[i("el-form-item",{attrs:{label:"Ê†áÈ¢ò","label-width":e.formLabelWidth}},[i("el-input",{attrs:{maxlength:"50","show-word-limit":"",type:"text",placeholder:"ËØ∑ËæìÂÖ•Ê†áÈ¢ò",autocomplete:"off"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),i("el-form-item",{attrs:{label:"ÂÜÖÂÆπ","label-width":e.formLabelWidth}},[i("el-input",{attrs:{rows:"8",resize:"none",autosize:!1,maxlength:"200","show-word-limit":"",type:"textarea",placeholder:"ËØ∑ËæìÂÖ•Âø´Êç∑ËØ≠",autocomplete:"off"},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:e.closeModal}},[e._v("Âèñ Ê∂à")]),i("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("‰øù Â≠ò")])],1)],1)},T=[],O={name:"mini-im-create-shortcuts",data:function(){return{form:{content:"",title:""},formLabelWidth:"40px"}},props:{dialogFormVisible:Boolean,complete:Function},mounted:function(){},methods:{closeModal:function(){this.$emit("update:dialogFormVisible",!1)},save:function(){var e=this;if(""!=this.form.title.trim()&&""!=this.form.content.trim()){var t=this.$loading({lock:!0,text:"‰øùÂ≠ò‰∏≠...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.5)"});x.a.post("/shortcut",this.form).then((function(i){try{console.log(i),t.close(),e.$message.success("Ê∑ªÂä†ÊàêÂäü"),e.closeModal(),e.complete(),e.form={content:"",title:""}}catch(s){console.log(s)}})).catch((function(i){t.close(),e.$message.error(i.response.data.message)}))}}}},R=O,P=Object(f["a"])(R,E,T,!1,null,"ae51b748",null),L=P.exports,V=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{attrs:{width:"600px",title:"ÁºñËæëÂø´Êç∑ËØ≠","show-close":!1,visible:e.dialogFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[i("el-form",{attrs:{model:e.form}},[i("el-form-item",{attrs:{label:"Ê†áÈ¢ò","label-width":e.formLabelWidth}},[i("el-input",{attrs:{maxlength:"50","show-word-limit":"",type:"text",placeholder:"ËØ∑ËæìÂÖ•Ê†áÈ¢ò",autocomplete:"off"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),i("el-form-item",{attrs:{label:"ÂÜÖÂÆπ","label-width":e.formLabelWidth}},[i("el-input",{attrs:{rows:"8",resize:"none",autosize:!1,maxlength:"200","show-word-limit":"",type:"textarea",placeholder:"ËØ∑ËæìÂÖ•Âø´Êç∑ËØ≠",autocomplete:"off"},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:e.closeModal}},[e._v("Âèñ Ê∂à")]),i("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("‰øù Â≠ò")])],1)],1)},N=[],F={name:"mini-im-edit-shortcuts",data:function(){return{form:{content:"",title:""},formLabelWidth:"40px"}},props:{dialogFormVisible:Boolean,complete:Function,formData:Object},methods:{closeModal:function(){this.$emit("update:dialogFormVisible",!1)},save:function(){var e=this;if(""!=this.form.title.trim()&&""!=this.form.content.trim()){var t=this.$loading({lock:!0,text:"‰øùÂ≠ò‰∏≠...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.5)"});x.a.put("/shortcut",this.form).then((function(i){try{console.log(i),t.close(),e.$message.success("Ê∑ªÂä†ÊàêÂäü"),e.closeModal(),e.complete()}catch(s){console.log(s)}})).catch((function(i){t.close(),e.$message.error(i.response.data.message)}))}}},watch:{formData:function(){this.form=Object.assign({},this.form,this.formData)}}},z=F,j=Object(f["a"])(z,V,N,!1,null,"3714045a",null),D=j.exports,A=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"mini-im-chat-list"},[i("div",{staticClass:"mini-im-chat-message-box"},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],staticClass:"loading"},[i("i",{staticClass:"el-icon-loading"}),i("span",[e._v("Ê∂àÊÅØÂä†ËΩΩ‰∏≠...")])]),i("el-button",{directives:[{name:"show",rawName:"v-show",value:e.isMessageEnd,expression:"isMessageEnd"}],attrs:{type:"text",disabled:"",icon:"el-icon-refresh-right"}},[e._v("Êó†Êõ¥Â§öËÅäÂ§©ËÆ∞ÂΩï...")]),e.isMessageEnd||e.loading?e._e():i("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.onLoadMor}},[e._v("ÁÇπÂáªÂä†ËΩΩÊõ¥Â§öËÅäÂ§©ËÆ∞ÂΩï")])],1),i("div",{staticClass:"mini-im-chat-message-box"},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.messages.length<=0&&!e.loading,expression:"messages.length <= 0 && !loading"}],staticClass:"loading"},[i("i",{staticClass:"el-icon-time"}),i("span",[e._v("ÊöÇÊó†ËÅäÂ§©ËÆ∞ÂΩï...")])])]),e._l(e.messages,(function(t,s){return i("div",{key:s,staticClass:"mini-im-chat-message-box",class:{self:t.from_account!=e.seviceCurrentUser.id}},["text"==t.biz_type||"photo"==t.biz_type||"knowledge"==t.biz_type||"knowledge_list"==t.biz_type?[i("div",{staticClass:"user-date"},[t.from_account==e.adminInfo.id?i("span",[e._v("\n              "+e._s(e.adminInfo.nickname||e.adminInfo.username)+"\n            ")]):t.from_account==e.seviceCurrentUser.from_account?i("span",[e._v("\n              "+e._s(e.seviceCurrentUser.nickname)+"\n            ")]):i("span",[i("span",{staticStyle:{"font-size":"12px",color:"#666"}},[e._v("(Êú∫Âô®‰∫∫)")]),e._v(e._s(e.$robotNickname(t.from_account))+"\n            ")]),i("em",[e._v(e._s(e.$formatFromNowDate(t.timestamp)))])])]:e._e(),"text"==t.biz_type?[i("div",{staticClass:"text"},[t.from_account==e.adminInfo.id&&t.isShowCancel?i("div",{staticClass:"cancel-btn",attrs:{title:"Êí§ÂõûÊú¨Êù°Ê∂àÊÅØ"},on:{click:function(){return e.onCancelMessage(t.key)}}},[e._v("\n              Êí§Âõû\n            ")]):e._e(),i("span",{domProps:{innerHTML:e._s(t.payload.replace(/\n/gi,"<br />"))}})])]:e._e(),"photo"==t.biz_type?[i("div",{staticClass:"photo"},[t.percent&&100!=t.percent?i("div",{staticClass:"loading"},[i("i",{staticClass:"el-icon-loading"}),i("span",[e._v(e._s(t.percent)+"%")])]):e._e(),t.from_account==e.adminInfo.id&&t.isShowCancel?i("div",{staticClass:"cancel-btn",attrs:{title:"Êí§ÂõûÊú¨Êù°Ê∂àÊÅØ"},on:{click:function(){return e.onCancelMessage(t.key)}}},[e._v("\n              Êí§Âõû\n            ")]):e._e(),i("div",{staticClass:"img-content"},[i("img",{attrs:{src:t.payload,preview:"1"}})])])]:e._e(),"transfer"==t.biz_type?[i("div",{staticClass:"system"},[i("em",[e._v(e._s(e.$formatFromNowDate(t.timestamp)))]),i("span",[e._v(e._s(t.payload))])])]:e._e(),"end"==t.biz_type?[i("div",{staticClass:"system"},[i("em",[e._v(e._s(e.$formatFromNowDate(t.timestamp)))]),t.to_account!=e.adminInfo.id?i("span",[e._v("‰Ω†ÁªìÊùü‰∫Ü‰ºöËØù")]):i("span",[e._v("ÂØπÊñπÁªìÊùü‰∫Ü‰ºöËØù")]),i("em",[e._v(e._s(e.$formatFromNowDate(t.timestamp)))])])]:e._e(),"timeout"==t.biz_type?[i("div",{staticClass:"system"},[i("em",[e._v(e._s(e.$formatFromNowDate(t.timestamp)))]),i("span",[e._v("Áî®Êà∑ÈïøÊó∂Èó¥Êó†Â∫îÁ≠îÔºå‰ºöËØùÁªìÊùü")])])]:e._e(),"cancel"==t.biz_type?[i("div",{staticClass:"system"},[i("em",[e._v(e._s(e.$formatFromNowDate(t.timestamp)))]),t.from_account==e.adminInfo.id?i("span",[e._v("ÊÇ®Êí§Âõû‰∫Ü‰∏ÄÊù°Ê∂àÊÅØ")]):i("span",[e._v("ÂØπÊñπÊí§Âõû‰∫Ü‰∏ÄÊù°Ê∂àÊÅØ")])])]:e._e(),"knowledge"==t.biz_type?[i("div",{staticClass:"knowledge"},[i("div",{staticClass:"content"},[i("div",{staticClass:"title"},[e._v("‰ª•‰∏ãÊòØÂê¶ÊòØÊÇ®ÂÖ≥ÂøÉÁöÑÁõ∏ÂÖ≥ÈóÆÈ¢òÂë¢Ôºü")]),e._l(JSON.parse(t.payload),(function(t,s){return i("div",{key:s,staticClass:"item"},[e._v("\n                "+e._s(s+1)+"."+e._s(t.title)+"\n              ")])}))],2)])]:e._e()],2)}))],2)},B=[],G={name:"mini-im-contact",data:function(){return{}},computed:{seviceCurrentUser:function(){return this.$store.getters.seviceCurrentUser||{}},adminInfo:function(){return this.$store.getters.adminInfo||{}}},props:{loading:Boolean,onCancelMessage:Function,messages:Array,onLoadMor:Function,isMessageEnd:Boolean},watch:{messages:function(){var e=this;setTimeout((function(){e.$previewRefresh()}),1e3)}}},K=G,W=(i("24fd"),Object(f["a"])(K,A,B,!1,null,"019193ce",null)),H=W.exports,J=i("fb21"),Y=i("b730"),q=i.n(Y),X=i("2f62");function Q(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}function Z(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(i),!0).forEach((function(t){r(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Q(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var ee={name:"workbench",components:{EmojiComponent:v,ContactComponent:y,UserInfoComponent:U,ChatWindowComponent:H,CreateShortcutComponent:L,EditShortcutComponent:D},data:function(){return{chatValue:"",advanceText:"",admins:[],shortcuts:[],shortcutKey:"",createShortcutDialogFormVisible:!1,editShortcutDialogFormVisible:!1,editShortcutItem:null,shortcutEditVisible:!1,getMessageRecordLoading:!0,chatWindowLoading:!1,currentSessionIsEnd:!1,getMessageRecordPageSize:20,isInputPongIng:!1,isSendPong:!1,inputPongIngString:"ÂØπÊñπÊ≠£Âú®ËæìÂÖ•...",isPush:!1,isMessageEnd:!1,mousemoveTimerout:null}},computed:Z({filterShortcuts:function(){var e=this.shortcutKey.trim();return""!=e?this.shortcuts.filter((function(t){return-1!=t.title.indexOf(e)})):this.shortcuts},filterAdmins:function(){var e=this;return this.admins.filter((function(t){return t.id!=e.adminInfo.id&&(1==t.online||2==t.online)}))}},Object(X["b"])(["contacts","adminInfo","seviceCurrentUser","messageRecord"])),mounted:function(){var e=this;document.ondblclick=function(){e.shortcutEditVisible=!1},this.init(),document.addEventListener("mousemove",this.onMousemoveEvent,!1),document.addEventListener("paste",this.inputPaste,!1)},beforeDestroy:function(){document.removeEventListener("mousemove",this.onMousemoveEvent,!1),document.removeEventListener("paste",this.inputPaste,!1),this.changeCurrentUser()},methods:{init:function(){var e=this;if(!this.adminInfo)return this.$store.dispatch("ON_GET_ME"),void setTimeout((function(){return e.init()}),100);this.getShortcuts(),this.chatWindowLoading=!0,setTimeout((function(){e.chatWindowLoading=!1}),1500),setTimeout((function(){var t,i=e.$store.getters.seviceCurrentUser.id||e.$route.query.uid;(e.changeCurrentUser(i||0),i)&&(e.contacts.map((function(e){e.from_account==i&&(t=e)})),history.replaceState(null,null,location.href.replace(/uid=\d+/i,"uid="+i)),e.$store.commit("onChangeSeviceCurrentUser",t),t&&e.selectUser(t),e.getMessageRecord(),e.scrollIntoBottom())}),1e3),this.$mimcInstance.addEventListener("statusChange",(function(t){1==e.adminInfo.online?e.$message.success("ÊÇ®ÂΩìÂâçÁä∂ÊÄÅ‰∏∫Âú®Á∫ø"):2==e.adminInfo.online&&e.$message.warning("ÊÇ®ÂΩìÂâçÁä∂ÊÄÅ‰∏∫ÁπÅÂøô"),t||e.$store.dispatch("ON_GET_ME").then((function(){0!=e.adminInfo.online&&e.init()}))})),this.$mimcInstance.addEventListener("receiveP2PMsg",this.receiveP2PMsg),this.$mimcInstance.addEventListener("disconnect",(function(){console.log("ÈìæÊé•Êñ≠ÂºÄÔºÅ");var t=e.adminInfo;0!=t.online?(e.adminInfo=null,e.init()):(t.online=0,e.$store.commit("onChangeAdminInfo",t))}))},onMousemoveEvent:function(){var e=this;this.$refs.miniImChatViewBontentBody&&(this.$refs.miniImChatViewBontentBody.style.height=document.body.clientHeight-155+"px"),this.isPush=!1,this.mousemoveTimerout&&clearTimeout(this.mousemoveTimerout),this.mousemoveTimerout=setTimeout((function(){e.isPush=!0}),3e4)},enterShift:function(e){"Enter"!=e.code&&(this.chatValue=this.chatValue+"\n")},scrollIntoBottom:function(){try{setTimeout((function(){var e=document.getElementById("chatBody");if(e){var t=e.clientHeight,i=e.scrollHeight;e.scrollTop=i-t}}),50)}catch(e){console.log(e)}},deleteContact:function(e){var t=this;e&&e.cid&&x.a.delete("/contact/"+e.cid).then((function(){t.$message.success("Âà†Èô§ÊàêÂäü"),t.$store.dispatch("ON_GET_CONTACTS"),t.seviceCurrentUser.id==e.id&&(t.changeCurrentUser(),t.$store.commit("onChangeSeviceCurrentUser",null))})).catch((function(e){t.$message.error(e.response.data.message)}))},clearContact:function(){var e=this;this.$confirm("ÊÇ®Á°ÆÂÆöË¶ÅÊ∏ÖÁ©∫ÂàóË°®Âêó? ","Ê∏©È¶®ÊèêÁ§∫ÔºÅ",{confirmButtonText:"Á°ÆÂÆö",cancelButtonText:"ÂèñÊ∂à",center:!0,type:"warning"}).then((function(){x.a.delete("/contact/clear").then((function(){e.$message.success("Ê∏ÖÁ©∫ÊàêÂäü"),e.$store.dispatch("ON_GET_CONTACTS"),e.changeCurrentUser(),e.$store.commit("onChangeSeviceCurrentUser",null)})).catch((function(t){e.$message.error(t.response.data.message)}))}))},clickEmoji:function(e){0!=this.adminInfo.online?1!=this.seviceCurrentUser.is_session_end?(this.chatValue=this.chatValue+e,this.$refs.chatValueDom.focus()):this.$message.info("ÂΩìÂâç‰ºöËØùÂ∑≤ÁªìÊùüÔºÅ"):this.$message.info("ÊÇ®ÂΩìÂâç‰∏∫Á¶ªÁ∫øÁä∂ÊÄÅÔºÅ")},checkShortcut:function(e){0!=this.adminInfo.online?1!=this.seviceCurrentUser.is_session_end?(this.shortcutKey="",this.chatValue=e,this.$refs.chatValueDom.focus()):this.$message.info("ÂΩìÂâç‰ºöËØùÂ∑≤ÁªìÊùüÔºÅ"):this.$message.info("ÊÇ®ÂΩìÂâç‰∏∫Á¶ªÁ∫øÁä∂ÊÄÅÔºÅ")},getShortcuts:function(){var e=this;x.a.get("/shortcut/list").then((function(t){e.shortcuts=t.data.data})).catch((function(t){e.$message.error(t.response.data.message)}))},editShortcut:function(e){this.editShortcutItem=e,this.editShortcutDialogFormVisible=!0},getAdmins:function(){var e=this;x.a.post("/admin/list",{page_on:1,page_size:1e4,online:3}).then((function(t){e.loading=!1,e.admins=t.data.data.list})).catch((function(t){e.$message.error(t.response.data.message)}))},deleteShortcut:function(e){var t=this;this.$confirm("ÊÇ®Á°ÆÂÆöË¶ÅÂà†Èô§ËØ•Âø´Êç∑ËØ≠Âêó?","Ê∏©È¶®ÊèêÁ§∫ÔºÅ",{confirmButtonText:"Á°ÆÂÆö",cancelButtonText:"ÂèñÊ∂à",center:!0,type:"warning"}).then((function(){x.a.delete("/shortcut/"+e.id).then((function(){t.$message.success("Âà†Èô§ÊàêÂäü"),t.getShortcuts()})).catch((function(e){t.$message.error(e.response.data.message)}))}))},onCancelMessage:function(e){var t=this.$mimcInstance.sendMessage("cancel",this.seviceCurrentUser.from_account,e);this.messageRecord.list.push(t),this.removeMessage(this.adminInfo.id,e),this.qiniuObservable&&this.qiniuObservable.unsubscribe()},transferCustomer:function(e){var t=this;this.$confirm("ÊÇ®Á°ÆÂÆöÂ∞ÜËØ•ÂÆ¢Êà∑ËΩ¨Êé•Áªô "+(e.nickname||e.username)+" Âêó?","Ê∏©È¶®ÊèêÁ§∫ÔºÅ",{confirmButtonText:"ËΩ¨Êé•",cancelButtonText:"ÂèñÊ∂à",center:!0,type:"warning"}).then((function(){x.a.post("/message/transfer",{to_account:e.id,user_account:t.seviceCurrentUser.from_account}).then((function(){var e=t.seviceCurrentUser;e.is_session_end=1,t.$store.commit("onChangeSeviceCurrentUser",e)})).catch((function(e){t.$message.error(e.response.data.message)}))}))},closeSession:function(){var e=this;this.$confirm("ÊÇ®Á°ÆÂÆöÁªìÊùüÂΩìÂâç‰ºöËØùÂêó?Âº∫Âà∂ÁªìÊùüÂèØËÉΩ‰ºöË¢´ÂÆ¢Êà∑ÊäïËØâÔºÅ","Ê∏©È¶®ÊèêÁ§∫ÔºÅ",{confirmButtonText:"ÁªìÊùü",cancelButtonText:"ÂèñÊ∂à",center:!0,type:"warning"}).then((function(){var t=e.$mimcInstance.sendMessage("end",e.seviceCurrentUser.from_account,"");e.messageRecord.list.push(t);var i=e.seviceCurrentUser;i.is_session_end=1,e.$store.commit("onChangeSeviceCurrentUser",i)}))},changeUserOnlineStatus:function(e){var t=this;x.a.put("/admin/online/"+e).then((function(){t.$store.dispatch("ON_GET_ME"),0==e&&t.$message.info("ÂΩìÂâçÁä∂ÊÄÅ‰∏∫Á¶ªÁ∫ø")})).catch((function(e){t.$message.error(e.response.data.message)}))},online:function(e){var t=this;t.adminInfo.online!=e&&t.$confirm("ÊÇ®Á°ÆÂÆö"+(0==e?"‰∏ãÁ∫ø":1==e?"‰∏äÁ∫ø":"ËÆæÁΩÆÁπÅÂøô")+"ÂêóÔºÅ","Ê∏©È¶®ÊèêÁ§∫ÔºÅ",{confirmButtonText:"Á°ÆÂÆö",cancelButtonText:"ÂèñÊ∂à",center:!0,type:"warning"}).then((function(){0==e?(t.$mimcInstance.logout(),t.changeUserOnlineStatus(e),t.$store.commit("onChangeMimcUser",null)):t.$mimcInstance.login((function(){t.changeUserOnlineStatus(e),t.$store.dispatch("ON_RUN_LAST_ACTiIVITY"),t.$store.dispatch("ON_GET_CONTACTS"),t.$store.commit("onChangeMimcUser",t.$mimcInstance.user)}))}))},receiveP2PMsg:function(e){var t=this,i=parseInt(((new Date).getTime()+"").substr(0,10));if(e.timestamp=parseInt((e.timestamp+"").substr(0,10)),(e.from_account!=this.adminInfo.id||"pong"!=e.biz_type)&&"into"!=e.biz_type){if(e.from_account==this.adminInfo.id&&this.seviceCurrentUser.from_account==e.to_account)return this.messageRecord.list.push(e),"cancel"==e.biz_type&&this.removeMessage(e.from_account,e.payload),this.scrollIntoBottom(),void this.$previewRefresh();if("text"==e.biz_type&&e.from_account==this.seviceCurrentUser.from_account&&(this.advanceText=""),"contacts"!=e.biz_type){if(!(i-e.timestamp>=60))if("cancel"==e.biz_type&&this.removeMessage(e.from_account,e.payload),"handshake"!=e.biz_type){if("pong"==e.biz_type&&e.from_account==this.seviceCurrentUser.from_account)return this.advanceText=e.payload,void this.inputPongIng();if("contacts"!=e.biz_type&&"pong"!=e.biz_type&&"welcome"!=e.biz_type&&"cancel"!=e.biz_type&&"handshake"!=e.biz_type&&"end"!=e.biz_type&&"timeout"!=e.biz_type&&this.isPush&&q.a.Permission.has()&&q.a.create("Êî∂Âà∞‰∏ÄÊù°Êñ∞Ê∂àÊÅØ",{body:e.payload,icon:this.$store.state.pushIcon,timeout:5e3,onClick:function(){t.$router.push({path:"/workbench?uid="+e.from_account}),window.focus(),setTimeout((function(){return t.getMessageRecord()}),1e3)}}),e.from_account==this.seviceCurrentUser.from_account){if("end"==e.biz_type){var s=this.seviceCurrentUser;s.is_session_end=1,this.$store.commit("onChangeSeviceCurrentUser",s),this.advanceText=""}this.messageRecord.list.push(e);var n=JSON.stringify(this.messageRecord);this.$store.commit("onChangeMessageRecord",JSON.parse(n)),this.scrollIntoBottom(),this.$previewRefresh()}}else setTimeout((function(){t.$mimcInstance.sendMessage("text",e.from_account,t.adminInfo.auto_reply),void 0!=t.seviceCurrentUser&&null!=t.seviceCurrentUser&&setTimeout((function(){return t.getMessageRecord()}),1e3)}),500)}else{var o=JSON.parse(e.payload);this.$store.commit("onChangeContacts",o)}}},changeCurrentUser:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;"{}"!=JSON.stringify(this.adminInfo)&&x.a.get("/admin/current/user/"+e)},sendMessage:function(){if(0!=this.adminInfo.online){if(1!=this.seviceCurrentUser.is_session_end)if(1!=this.seviceCurrentUser.is_session_end){var e=this.chatValue.trim();if(""!=e){this.shortcutEditVisible=!1,this.scrollIntoBottom();var t=this.$mimcInstance.sendMessage("text",this.seviceCurrentUser.from_account,this.chatValue.trim("\n"));t.isShowCancel=!0,setTimeout((function(){return t.isShowCancel=!1}),1e4),this.messageRecord.list.push(t),this.chatValue=""}else this.chatValue=""}else this.$message.info("ÂΩìÂâç‰ºöËØùÂ∑≤ÁªìÊùüÔºÅ")}else this.$message.info("ÊÇ®ÂΩìÂâç‰∏∫Á¶ªÁ∫øÁä∂ÊÄÅÔºÅ")},sendPhotoMessageEvent:function(e){var t=e.target,i=t.files[0];this.sendPhotoMessage(i)},sendPhotoMessage:function(e){if(0!=this.adminInfo.online)if(1!=this.seviceCurrentUser.is_session_end){var t=new FileReader;t.readAsDataURL(e);var i,s=this;t.onload=function(){i=s.$mimcInstance.createLocalMessage("photo",s.seviceCurrentUser.from_account,this.result),i["percent"]=0,i.isShowCancel=!0,s.messageRecord.list.push(i),setTimeout((function(){return i.isShowCancel=!1}),1e4),s.$previewRefresh(),s.scrollIntoBottom(),Object(J["a"])({file:e,progress:function(e){i.percent=e},success:function(e){i.percent=100;var t=s.$store.getters.uploadToken.host+"/"+e;s.$mimcInstance.sendMessage("photo",s.seviceCurrentUser.from_account,t)},error:function(e){i.percent=0,s.$message.error(e.message)}})}}else this.$message.info("ÂΩìÂâç‰ºöËØùÂ∑≤ÁªìÊùüÔºÅ");else this.$message.info("ÊÇ®ÂΩìÂâç‰∏∫Á¶ªÁ∫øÁä∂ÊÄÅÔºÅ")},selectUser:function(e){var t=location.href,i=t.indexOf("#");t=t.substr(0,-1!=i?i:t.length),history.replaceState(null,null,t+"#/workbench?uid="+e.from_account),this.isMessageEnd=!1,this.seviceCurrentUser.from_account!=e.from_account&&(this.messageRecord.list=[],this.$store.commit("onChangeSeviceCurrentUser",e),this.changeCurrentUser(e.from_account)),this.timestamp=void 0,this.getMessageRecord(),this.advanceText=""},getMessageRecord:function(e){var t=this;this.getMessageRecordLoading=!0,void 0==e&&(e=0);var i=parseInt(this.seviceCurrentUser.from_account);i&&x.a.post("/message/list",{timestamp:e,page_size:this.getMessageRecordPageSize,account:i}).then((function(i){t.getMessageRecordLoading=!1,i.data.data.list.length<t.getMessageRecordPageSize&&(t.isMessageEnd=!0),0==t.messageRecord.list.length||0==e?(t.$store.commit("onChangeMessageRecord",i.data.data),t.scrollIntoBottom()):(i.data.data.list=i.data.data.list.concat(t.messageRecord.list),t.$store.commit("onChangeMessageRecord",i.data.data)),setTimeout((function(){return t.$previewRefresh()}),1e3),t.$store.dispatch("ON_GET_CONTACTS")})).catch((function(){t.getMessageRecordLoading=!1}))},onLoadMorMessage:function(){this.getMessageRecordLoading||(this.messageRecord.list.length>=this.messageRecord.total||this.messageRecord.total<=this.getMessageRecordPageSize?this.isMessageEnd=!0:(this.getMessageRecord(this.messageRecord.list[0].timestamp),setTimeout((function(){var e=document.getElementById("chatBody");e.scrollTop=500}),50)))},inputPongIng:function(){var e=this;this.isInputPongIng||(this.isInputPongIng=!0,setTimeout((function(){e.inputPongIngString="ÂØπÊñπÊ≠£Âú®ËæìÂÖ•."}),500),setTimeout((function(){e.inputPongIngString="ÂØπÊñπÊ≠£Âú®ËæìÂÖ•.."}),1500),setTimeout((function(){e.inputPongIngString="ÂØπÊñπÊ≠£Âú®ËæìÂÖ•...",e.isInputPongIng=!1}),3e3))},keyUpEvent:function(){var e=this;this.isSendPong||(this.isSendPong=!0,setTimeout((function(){return e.isSendPong=!1}),500),this.$mimcInstance.sendMessage("pong",this.seviceCurrentUser.from_account,""))},removeMessage:function(e,t){for(var i=[],s=this.messageRecord.list,n=0;n<s.length;n++)s[n].key==t&&s[n].from_account==e||i.push(s[n]);this.messageRecord.list=i,this.$store.commit("onChangeMessageRecord",this.messageRecord)},inputPaste:function(e){if(this.seviceCurrentUser.id&&1!=this.seviceCurrentUser.is_session_end){var t=this,i=e.clipboardData,s=window.navigator.userAgent;if(e.clipboardData&&e.clipboardData.items&&!(i.items&&2===i.items.length&&"string"===i.items[0].kind&&"file"===i.items[1].kind&&i.types&&2===i.types.length&&"text/plain"===i.types[0]&&"Files"===i.types[1]&&s.match(/Macintosh/i)&&Number(s.match(/Chrome\/(\d{2})/i)[1])<49))for(var n=0;n<i.items.length;n++){var o=i.items[n];if("file"==o.kind){var a=o.getAsFile();if(0===a.size)return;var r=new FileReader;r.readAsDataURL(a),r.onload=function(){var e=this.result;t.$alert('<img preview="1" style="width:100%;max-height: 500px;" src="'+e+'" />',"Ê£ÄÊµãÂà∞ÂõæÁâáÊòØÂê¶Ë¶ÅÂèëÈÄÅÔºü",{dangerouslyUseHTMLString:!0,showCancelButton:!0,confirmButtonText:"ÂèëÈÄÅ"}).then((function(){t.sendPhotoMessage(a)})),t.$previewRefresh()}}}}}},watch:{messageRecord:function(){this.$previewRefresh()}}},te=ee,ie=(i("a5f6"),Object(f["a"])(te,s,n,!1,null,"6878cee2",null));t["default"]=ie.exports},"2b0b":function(e,t,i){"use strict";var s=i("752b"),n=i.n(s);n.a},"454f":function(e,t,i){i("46a7");var s=i("584a").Object;e.exports=function(e,t,i){return s.defineProperty(e,t,i)}},"456d":function(e,t,i){var s=i("4bf8"),n=i("0d58");i("5eda")("keys",(function(){return function(e){return n(s(e))}}))},"46a7":function(e,t,i){var s=i("63b6");s(s.S+s.F*!i("8e60"),"Object",{defineProperty:i("d9f6").f})},4917:function(e,t,i){"use strict";var s=i("cb7c"),n=i("9def"),o=i("0390"),a=i("5f1b");i("214f")("match",1,(function(e,t,i,r){return[function(i){var s=e(this),n=void 0==i?void 0:i[t];return void 0!==n?n.call(i,s):new RegExp(i)[t](String(s))},function(e){var t=r(i,e,this);if(t.done)return t.value;var c=s(e),l=String(this);if(!c.global)return a(c,l);var u=c.unicode;c.lastIndex=0;var m,d=[],f=0;while(null!==(m=a(c,l))){var h=String(m[0]);d[f]=h,""===h&&(c.lastIndex=o(l,n(c.lastIndex),u)),f++}return 0===f?null:d}]}))},"4e10":function(e,t,i){},"4f37":function(e,t,i){"use strict";i("aa77")("trim",(function(e){return function(){return e(this,3)}}))},"58b2":function(e,t,i){var s=i("5ca1");s(s.S+s.F*!i("9e1e"),"Object",{defineProperties:i("1495")})},"5dbc":function(e,t,i){var s=i("d3f4"),n=i("8b97").set;e.exports=function(e,t,i){var o,a=t.constructor;return a!==i&&"function"==typeof a&&(o=a.prototype)!==i.prototype&&s(o)&&n&&n(e,o),e}},"5eda":function(e,t,i){var s=i("5ca1"),n=i("8378"),o=i("79e5");e.exports=function(e,t){var i=(n.Object||{})[e]||Object[e],a={};a[e]=t(i),s(s.S+s.F*o((function(){i(1)})),"Object",a)}},"752b":function(e,t,i){},"85f2":function(e,t,i){e.exports=i("454f")},"8b97":function(e,t,i){var s=i("d3f4"),n=i("cb7c"),o=function(e,t){if(n(e),!s(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,s){try{s=i("9b43")(Function.call,i("11e9").f(Object.prototype,"__proto__").set,2),s(e,[]),t=!(e instanceof Array)}catch(n){t=!0}return function(e,i){return o(e,i),t?e.__proto__=i:s(e,i),e}}({},!1):void 0),check:o}},"8e6e":function(e,t,i){var s=i("5ca1"),n=i("990b"),o=i("6821"),a=i("11e9"),r=i("f1ae");s(s.S,"Object",{getOwnPropertyDescriptors:function(e){var t,i,s=o(e),c=a.f,l=n(s),u={},m=0;while(l.length>m)i=c(s,t=l[m++]),void 0!==i&&r(u,t,i);return u}})},9093:function(e,t,i){var s=i("ce10"),n=i("e11e").concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return s(e,n)}},"990b":function(e,t,i){var s=i("9093"),n=i("2621"),o=i("cb7c"),a=i("7726").Reflect;e.exports=a&&a.ownKeys||function(e){var t=s.f(o(e)),i=n.f;return i?t.concat(i(e)):t}},a481:function(e,t,i){"use strict";var s=i("cb7c"),n=i("4bf8"),o=i("9def"),a=i("4588"),r=i("0390"),c=i("5f1b"),l=Math.max,u=Math.min,m=Math.floor,d=/\$([$&`']|\d\d?|<[^>]*>)/g,f=/\$([$&`']|\d\d?)/g,h=function(e){return void 0===e?e:String(e)};i("214f")("replace",2,(function(e,t,i,v){return[function(s,n){var o=e(this),a=void 0==s?void 0:s[t];return void 0!==a?a.call(s,o,n):i.call(String(o),s,n)},function(e,t){var n=v(i,e,this,t);if(n.done)return n.value;var m=s(e),d=String(this),f="function"===typeof t;f||(t=String(t));var p=m.global;if(p){var _=m.unicode;m.lastIndex=0}var b=[];while(1){var C=c(m,d);if(null===C)break;if(b.push(C),!p)break;var y=String(C[0]);""===y&&(m.lastIndex=r(d,o(m.lastIndex),_))}for(var w="",S=0,k=0;k<b.length;k++){C=b[k];for(var x=String(C[0]),$=l(u(a(C.index),d.length),0),I=[],M=1;M<C.length;M++)I.push(h(C[M]));var U=C.groups;if(f){var E=[x].concat(I,$,d);void 0!==U&&E.push(U);var T=String(t.apply(void 0,E))}else T=g(x,d,$,I,U,t);$>=S&&(w+=d.slice(S,$)+T,S=$+x.length)}return w+d.slice(S)}];function g(e,t,s,o,a,r){var c=s+e.length,l=o.length,u=f;return void 0!==a&&(a=n(a),u=d),i.call(r,u,(function(i,n){var r;switch(n.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,s);case"'":return t.slice(c);case"<":r=a[n.slice(1,-1)];break;default:var u=+n;if(0===u)return i;if(u>l){var d=m(u/10);return 0===d?i:d<=l?void 0===o[d-1]?n.charAt(1):o[d-1]+n.charAt(1):i}r=o[u-1]}return void 0===r?"":r}))}}))},a5f6:function(e,t,i){"use strict";var s=i("0344"),n=i.n(s);n.a},aa77:function(e,t,i){var s=i("5ca1"),n=i("be13"),o=i("79e5"),a=i("fdef"),r="["+a+"]",c="‚Äã¬Ö",l=RegExp("^"+r+r+"*"),u=RegExp(r+r+"*$"),m=function(e,t,i){var n={},r=o((function(){return!!a[e]()||c[e]()!=c})),l=n[e]=r?t(d):a[e];i&&(n[i]=l),s(s.P+s.F*r,"String",n)},d=m.trim=function(e,t){return e=String(n(e)),1&t&&(e=e.replace(l,"")),2&t&&(e=e.replace(u,"")),e};e.exports=m},ac6a:function(e,t,i){for(var s=i("cadf"),n=i("0d58"),o=i("2aba"),a=i("7726"),r=i("32e9"),c=i("84f2"),l=i("2b4c"),u=l("iterator"),m=l("toStringTag"),d=c.Array,f={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},h=n(f),v=0;v<h.length;v++){var g,p=h[v],_=f[p],b=a[p],C=b&&b.prototype;if(C&&(C[u]||r(C,u,d),C[m]||r(C,m,p),c[p]=d,_))for(g in s)C[g]||o(C,g,s[g],!0)}},c5f6:function(e,t,i){"use strict";var s=i("7726"),n=i("69a8"),o=i("2d95"),a=i("5dbc"),r=i("6a99"),c=i("79e5"),l=i("9093").f,u=i("11e9").f,m=i("86cc").f,d=i("aa77").trim,f="Number",h=s[f],v=h,g=h.prototype,p=o(i("2aeb")(g))==f,_="trim"in String.prototype,b=function(e){var t=r(e,!1);if("string"==typeof t&&t.length>2){t=_?t.trim():d(t,3);var i,s,n,o=t.charCodeAt(0);if(43===o||45===o){if(i=t.charCodeAt(2),88===i||120===i)return NaN}else if(48===o){switch(t.charCodeAt(1)){case 66:case 98:s=2,n=49;break;case 79:case 111:s=8,n=55;break;default:return+t}for(var a,c=t.slice(2),l=0,u=c.length;l<u;l++)if(a=c.charCodeAt(l),a<48||a>n)return NaN;return parseInt(c,s)}}return+t};if(!h(" 0o1")||!h("0b1")||h("+0x1")){h=function(e){var t=arguments.length<1?0:e,i=this;return i instanceof h&&(p?c((function(){g.valueOf.call(i)})):o(i)!=f)?a(new v(b(t)),i,h):b(t)};for(var C,y=i("9e1e")?l(v):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),w=0;y.length>w;w++)n(v,C=y[w])&&!n(h,C)&&m(h,C,u(v,C));h.prototype=g,g.constructor=h,i("2aba")(s,f,h)}},d25f:function(e,t,i){"use strict";var s=i("5ca1"),n=i("0a49")(2);s(s.P+s.F*!i("2f21")([].filter,!0),"Array",{filter:function(e){return n(this,e,arguments[1])}})},eef3:function(e,t){var i=["üòÄ","üòÅ","üòÇ","ü§£","üòÉ","üòÑ","üòÖ","üòÜ","üòâ","üòä","üòã","üòé","üòç","üòò","üòó","üòô","üòö","üôÇ","ü§ó","ü§©","ü§î","ü§®","üòê","üòë","üò∂","üôÑ","üòè","üò£","üò•","üòÆ","ü§ê","üòØ","üò™","üò´","üò¥","üòå","üòõ","üòú","üòù","ü§§","üòí","üòì","üòî","üòï","üôÉ","ü§ë","üò≤","üôÅ","üòñ","üòû","üòü","üò§","üò¢","üò≠","üò¶","üòß","üò®","üò©","ü§Ø","üò¨","üò∞","üò±","üò≥","ü§™","üòµ","üò°","üò†","ü§¨","üò∑","ü§í","ü§ï","ü§¢","ü§Æ","ü§ß","üòá","ü§†","ü§°","ü§•","ü§´","ü§≠","üßê","ü§ì","üòà","üëø","üëπ","üë∫","üíÄ","üëª","üëΩ","ü§ñ","üí©","üò∫","üò∏","üòπ","üòª","üòº","üòΩ","üôÄ","üòø","üòæ","ü§≤","üëê","üôå","üëè","ü§ù","üëç","üëé","üëä","‚úä","ü§õ","ü§ú","ü§û","‚úåÔ∏è","ü§ü","ü§ò","üëå","üëà","üëâ","üëÜ","üëá","‚òùÔ∏è","‚úã","ü§ö","üñê","üññ","üëã","ü§ô","üí™","üñï","‚úçÔ∏è","üôè"];t.emojiData=i},f1ae:function(e,t,i){"use strict";var s=i("86cc"),n=i("4630");e.exports=function(e,t,i){t in e?s.f(e,t,n(0,i)):e[t]=i}},f3e2:function(e,t,i){"use strict";var s=i("5ca1"),n=i("0a49")(0),o=i("2f21")([].forEach,!0);s(s.P+s.F*!o,"Array",{forEach:function(e){return n(this,e,arguments[1])}})},fa4e:function(e,t,i){},fdef:function(e,t){e.exports="\t\n\v\f\r ¬†·öÄ·†é‚ÄÄ‚ÄÅ‚ÄÇ‚ÄÉ‚ÄÑ‚ÄÖ‚ÄÜ‚Äá‚Äà‚Äâ‚Ää‚ÄØ‚Åü„ÄÄ\u2028\u2029\ufeff"}}]);
//# sourceMappingURL=chunk-1a471d73.343ba417.js.map